<!DOCTYPE html>
<html translate="no">
<head>
	<title>Sample Embedded RomPatcherJS</title> <!-- Tab Title -->
	<link rel="icon" href="./favicon.ico" type="image/x-icon"> <!-- Tab Icon -->
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
	
	<!-- Rom Patcher JS needed CSS/JS files -->
	<link type="text/css" rel="stylesheet" href="./rom-patcher-js/style.css" media="all" />
	<script type="text/javascript" src="./rom-patcher-js/RomPatcher.webapp.js"></script>
	
	<!-- Custom CSS-->
	<link type="text/css" rel="stylesheet" href="style.css" media="all" />
	
	<!-- Rom Patcher JS initialization -->
	<script type="text/javascript">
		// ROM Patcher JS Settings
		const patcherSettings = {
			language: 'en',
			requireValidation: true, // If true, disallow invalid ROM
			allowDropFiles: true // If true, allow drag and dropping files
		};
		const autoPatchSelectEnabled = false // Only set to true if you have implemented automatic patch selection, generally using onLoadRom -> pickEmbededFile. Default is false.

		// ROM Hashes
		const CRC32_VALID = X; // Valid CRC32
		const MD5_VALID = 'X'; // Valid MD5
		const CRC32_INVALID = Y; // Invalid CRC32

		// Patches
		const patchInfo = {
			file: './patches.zip', // Path to .zip containing patches
			patches: [ // Info about patches contained in .zip
				{
					file: 'X.bps', // Required, must match the file name in the .zip
					name: 'X', // Patch name that appears in dropdown
					inputCrc32: CRC32_VALID, // CRC32 checksum validation
					inputMd5: MD5_VALID, // MD5 checksum validation
					description: 'Y', // Description that appears when patch is selected
					outputName: 'Generic Test.xyz' // Patched ROM file name
				}
			]
		};

		window.addEventListener('load', function (evt) {
			try {
				// HTML Objects - Separate since only exists after load
				const downloadBtn = document.getElementById('rom-patcher-button-download');
				const patchSelect = document.getElementById('rom-patcher-select-patch');
				const autoPatch = document.getElementById('auto-patch');

				RomPatcherWeb.initialize(
					{
						patcherSettings,
						onloadrom: function (romFile) { // When new ROM file is loaded
							const CRC32 = romFile.hashCRC32(); // Generate ROM file hash
							if (CRC32 === CRC32_VALID) // Load matching patch for hash
								RomPatcherWeb.pickEmbededFile('X.bps');
						},
						onvalidaterom: function (romFile, isRomValid) {
							const CRC32 = romFile.hashCRC32();
							if (!isRomValid) // If ROM is invalid
								if (CRC32_INVALID.indexOf(CRC32) !== -1) // If invalid ROM hash is known
									RomPatcherWeb.setErrorMessage('This ROM is known to be invalid for all provided patches.');
								else if (CRC32_INVALID.indexOf(CRC32) === -1) // If invalid ROM hash is not known
									RomPatcherWeb.setErrorMessage('This ROM is unknown and is likely invalid for all provided patches.');
						},
						onloadpatch: function (patchFile, embededPatchInformation) {
							if (patchSelect.selectedIndex < 0) // If no patch is selected, disable Download Patch button
								downloadBtn.disabled = true;
							else // If patch is selected, enable Download Patch button
								downloadBtn.disabled = false;
						}
					},
					patchInfo
				);
				
				// Patch Download
				downloadBtn.onclick = () => {
					const selectedIndex = patchSelect.selectedIndex;
					if (selectedIndex < 0) return;

					const patch = patchInfo.patches[selectedIndex];
					const link = document.createElement('a');
					link.href = `./patches/${patch.file}`;
					link.download = patch.file.split('/').pop();
					document.body.appendChild(link);
					link.click();
					document.body.removeChild(link);
				};

				// Update automatic patch selection text if enabled
				if (autoPatchSelectEnabled) {
					autoPatch.classList.add('auto-patch-enabled');
					autoPatch.classList.remove('auto-patch-disabled');
					autoPatch.textContent="Enabled";
				}
			} catch (err) {
				var message = err.message;
				if (/incompatible browser/i.test(message) || /variable RomPatcherWeb/i.test(message))
					message = 'Your browser is outdated and it is not compatible with this app.';

				document.getElementById('rom-patcher-container').innerHTML = message;
				document.getElementById('rom-patcher-container').style.color = 'red';
			}
		});
	</script>
</head>

<body id="body">
	<header id="header">
		<img id="logo" src="./logo.webp" alt="Logo for Pokémon Crystal Legacy" />
		<h1>Sample Title</h1>
		<p id="description">
			Sample Description.
		</p>
	</header>

	<!-- Rom Patcher JS container -->
	<!--
		The following elements are required for Rom Patcher JS to work:
			#rom-patcher-input-file-rom
			#rom-patcher-select-patch
			#rom-patcher-button-apply
		The rest of elements are informative and can be removed, though it's recommended to keep them for a better user experience.
	-->
	<div id="rom-patcher-container">
		<!-- Additional information -->
		<div id="base-rom-info" class="text-mono text-muted">
			<span>Base ROM: <span id="base-rom"></span></span>
		</div>
		<div id="auto-patch-info" class="text-mono text-muted">
			<!-- Do not edit if enabled, set "autoPatchSelectEnabled = true" instead -->
			<span>Auto Patch Select: <span id="auto-patch" class="auto-patch-disabled">Disabled</span></span>
		</div>

		<!-- ROM file selection and hashes -->
		<div class="rom-patcher-row margin-bottom" id="rom-patcher-row-file-rom">
			<div class="text-right"><label for="rom-patcher-input-file-rom" data-localize="yes">ROM file:</label></div>
			<div class="rom-patcher-container-input">
				<input type="file" id="rom-patcher-input-file-rom" class="empty" disabled />
			</div>
		</div>
		<div class="margin-bottom text-selectable text-mono text-muted" id="rom-patcher-rom-info">
			<div class="rom-patcher-row">
				<div class="text-right">CRC32:</div>
				<div class="text-truncate"><span id="rom-patcher-span-crc32"></span></div>
			</div>
			<div class="rom-patcher-row">
				<div class="text-right">MD5:</div>
				<div class="text-truncate"><span id="rom-patcher-span-md5"></span></div>
			</div>
			<div class="rom-patcher-row">
				<div class="text-right">SHA-1:</div>
				<div class="text-truncate"><span id="rom-patcher-span-sha1"></span></div>
			</div>
			<div class="rom-patcher-row" id="rom-patcher-row-info-rom">
				<div class="text-right">ROM:</div>
				<div class="text-truncate"><span id="rom-patcher-span-rom-info"></span></div>
			</div>
		</div>
	
		<!-- Patch file selection and information -->
		<div class="rom-patcher-row margin-bottom" id="rom-patcher-row-file-patch">
			<div class="text-right"><label for="rom-patcher-select-patch" data-localize="yes">Patch file:</label>
			</div>
			<div class="rom-patcher-container-input">
				<select id="rom-patcher-select-patch"></select>
			</div>
		</div>
		<div class="rom-patcher-row margin-bottom" id="rom-patcher-row-patch-description">
			<div class="text-right text-mono text-muted" data-localize="yes">Description:</div>
			<div class="text-truncate" id="rom-patcher-patch-description"></div>
		</div>
		<div class="rom-patcher-row margin-bottom text-selectable text-mono text-muted"
			id="rom-patcher-row-patch-requirements">
			<div class="text-right text-mono" id="rom-patcher-patch-requirements-type">ROM requirements:</div>
			<div class="text-truncate" id="rom-patcher-patch-requirements-value"></div>
		</div>

		<!-- Patch actions -->
		<div class="text-center" id="rom-patcher-row-apply">
			<div id="rom-patcher-row-error-message" class="margin-bottom"><span id="rom-patcher-error-message"></span>
			</div>
			<button id="rom-patcher-button-apply" data-localize="yes" disabled>Apply patch</button>
			<button id="rom-patcher-button-download" data-localize="yes" disabled>Download patch</button>
		</div>
	</div>
<!-- FOOTER -->
<footer>
	<!-- Rom Patcher JS -->
	<div id="rom-patcher-powered" class="text-center">
		<a href="https://github.com/marcrobledo/RomPatcher.js" target="_blank"><img
			src="rom-patcher-js/assets/powered_by_rom_patcher_js.png" loading="lazy" />Powered by Rom Patcher JS v3.2.1</a>
	</div>
	<!-- Patch Source - Strongly recommended -->
	<div class="footer-link">
		<a href="https://github.com" target="_blank"><img
				src="logos/github-light.webp" loading="lazy" />GitHub</a>
		</div><br>
	<!-- Additional links - Recommended -->
	<div id="footer-link-grid">
		<div class="footer-link">
			<a href="https://www.reddit.com" target="_blank"><img
					src="logos/reddit.webp" loading="lazy" />Reddit</a>
		</div>
		<div class="footer-link">
			<a href="https://discord.gg" target="_blank"><img
					src="logos/discord.webp" loading="lazy" />Discord</a>
		</div>
		<div class="footer-link">
			<a href="https://www.pokecommunity.com" target="_blank"><img
					src="logos/pokecommunity.webp" loading="lazy" />Pokécommunity</a>
		</div>
		<div class="footer-link">
			<a href="https://www.igdb.com" target="_blank"><img
					src="logos/igdb.webp" loading="lazy" />IGDB</a>
		</div>
		<div class="footer-link">
			<a href="https://retroachievements.org" target="_blank"><img
					src="logos/retroachievements.webp" loading="lazy" />Retroachievements</a>
		</div>
		<div class="footer-link">
			<a href="https://hasheous.org" target="_blank"><img
					src="logos/hasheous.webp" loading="lazy" />Hasheous</a>
		</div>
		<div class="footer-link">
			<a href="https://www.steamgriddb.com" target="_blank"><img
					src="logos/steamgriddb.webp" loading="lazy" />SteamGridDB</a>
		</div>
		<div class="footer-link">
			<a href="https://howlongtobeat.com" target="_blank"><img
					src="logos/hltb.webp" loading="lazy" />HowLongToBeat</a>
		</div>
		<div class="footer-link">
			<a href="https://www.screenscraper.fr" target="_blank"><img
					src="logos/screenscraper.webp" loading="lazy" />Screenscraper</a>
		</div>
	</div>
</footer>

</body>
	
</html>
